<% case activerecord_adapter -%>
<% when "postgresql" -%>
current_user = exec_query("SELECT current_user").rows[0][0]
user = "#{current_user}_password"
execute "GRANT REFERENCES ON accounts TO #{user}"
<% when "mysql2", "sqlserver" -%>
<% if activerecord_adapter == "mysql2" -%>
current_user = exec_query("SELECT current_user").rows[0][0]
user = current_user.sub(/_password@/, "@")
<% else -%>
user = exec_query("SELECT DB_NAME()").rows[0][0]
<% end -%>
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_statuses TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON accounts TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_authentication_audit_logs TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_password_reset_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_jwt_refresh_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_verification_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_login_change_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_remember_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_login_failures TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_email_auth_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_lockouts TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_password_change_times TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_activity_times TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_session_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_active_session_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_webauthn_user_ids TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_webauthn_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_otp_keys TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_recovery_codes TO #{user}"
execute "GRANT SELECT, INSERT, UPDATE, DELETE ON account_sms_codes TO #{user}"
<% end -%>
